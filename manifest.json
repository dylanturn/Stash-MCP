{
  "manifest_version": "0.3",
  "name": "stash-mcp",
  "display_name": "Stash",
  "version": "0.1.0",
  "description": "A file-backed content server that exposes documents to AI agents via MCP",
  "long_description": "Stash-MCP is a file-first content server that provides semantic search, git-based change tracking, and structured document management through the Model Context Protocol. Ideal for centralized knowledge stores accessible by AI agents.",
  "author": {
    "name": "Dylan Turnbull",
    "url": "https://github.com/dylanturn"
  },
  "repository": {
    "type": "git",
    "url": "https://github.com/dylanturn/Stash-MCP.git"
  },
  "license": "MIT",
  "icon": "icon.png",
  "icons": [
    { "src": "assets/icons/icon-light.png", "size": "128x128", "theme": "light" },
    { "src": "assets/icons/icon-dark.png", "size": "128x128", "theme": "dark" }
  ],
  "server": {
    "type": "python",
    "entry_point": "stash_mcp/server.py",
    "mcp_config": {
      "command": "uvx",
      "args": [
        "--from", "stash-mcp[search]",
        "stash-mcp-stdio"
      ],
      "env": {
        "STASH_CONTENT_ROOT": "${user_config.content_dir}",
        "STASH_READ_ONLY": "${user_config.read_only}",
        "STASH_SEARCH_ENABLED": "${user_config.search_enabled}",
        "STASH_SEARCH_EMBEDDER_MODEL": "${user_config.embedding_model}",
        "STASH_SEARCH_INDEX_DIR": "${user_config.search_index_dir}",
        "STASH_SEARCH_CHUNK_SIZE": "${user_config.search_chunk_size}",
        "STASH_SEARCH_CHUNK_OVERLAP": "${user_config.search_chunk_overlap}",
        "STASH_CONTEXTUAL_RETRIEVAL": "${user_config.contextual_retrieval}",
        "STASH_CONTEXTUAL_MODEL": "${user_config.contextual_model}",
        "STASH_MODEL_CACHE_DIR": "${user_config.model_cache_dir}",
        "STASH_CONTENT_PATHS": "${user_config.content_paths}",
        "STASH_SERVER_NAME": "${user_config.server_name}",
        "STASH_LOG_LEVEL": "${user_config.log_level}",
        "STASH_GIT_TRACKING": "${user_config.git_tracking}",
        "STASH_GIT_SYNC_ENABLED": "${user_config.git_sync_enabled}",
        "STASH_GIT_SYNC_REMOTE": "${user_config.git_sync_remote}",
        "STASH_GIT_SYNC_BRANCH": "${user_config.git_sync_branch}",
        "STASH_GIT_SYNC_INTERVAL": "${user_config.git_sync_interval}",
        "STASH_GIT_SYNC_RECURSIVE": "${user_config.git_sync_recursive}",
        "STASH_GIT_SYNC_TOKEN": "${user_config.git_sync_token}",
        "STASH_GIT_AUTHOR_DEFAULT": "${user_config.git_author}",
        "STASH_TRANSACTION_TIMEOUT": "${user_config.transaction_timeout}",
        "STASH_TRANSACTION_LOCK_WAIT": "${user_config.transaction_lock_wait}",
        "STASH_GIT_CLONE_URL": "${user_config.git_clone_url}",
        "STASH_GIT_CLONE_BRANCH": "${user_config.git_clone_branch}",
        "STASH_GIT_CLONE_TOKEN": "${user_config.git_clone_token}",
        "ANTHROPIC_API_KEY": "${user_config.anthropic_api_key}",
        "OPENAI_API_KEY": "${user_config.openai_api_key}"
      }
    }
  },
  "user_config": {
    "content_dir": {
      "type": "directory",
      "title": "Content Directory",
      "description": "Root directory for your content store. If using Git Clone, this is where the repo will be cloned to.",
      "required": true,
      "default": "${HOME}/stash-content"
    },
    "read_only": {
      "type": "boolean",
      "title": "Read-Only Mode",
      "description": "Restrict to read-only operations (no create, edit, delete, or move)",
      "default": false
    },
    "server_name": {
      "type": "string",
      "title": "Server Name",
      "description": "MCP server name identifier",
      "required": false,
      "default": "stash-mcp"
    },
    "log_level": {
      "type": "string",
      "title": "Log Level",
      "description": "Logging verbosity (debug, info, warning, error)",
      "required": false,
      "default": "info"
    },
    "content_paths": {
      "type": "string",
      "title": "Content Path Filters",
      "description": "Comma-separated glob patterns to filter which files are discoverable (e.g. 'docs/**,*.md'). Leave empty for all files.",
      "required": false,
      "default": ""
    },
    "git_clone_url": {
      "type": "string",
      "title": "Git Clone URL",
      "description": "HTTPS URL of a GitHub repo to clone as the content directory (e.g. https://github.com/org/repo.git). Leave empty to use a local directory.",
      "required": false,
      "default": ""
    },
    "git_clone_branch": {
      "type": "string",
      "title": "Git Clone Branch",
      "description": "Branch to checkout when cloning",
      "required": false,
      "default": "main"
    },
    "git_clone_token": {
      "type": "string",
      "title": "Git Clone Token",
      "description": "GitHub Personal Access Token for cloning private repositories. Also used for git sync if Git Sync Token is not set separately.",
      "required": false,
      "default": ""
    },
    "git_tracking": {
      "type": "boolean",
      "title": "Git Tracking",
      "description": "Enable git-based change tracking (log, diff, blame). The content directory must be a git repository.",
      "default": false
    },
    "git_sync_enabled": {
      "type": "boolean",
      "title": "Git Sync",
      "description": "Enable periodic git pull to keep content fresh. Requires Git Tracking to be enabled.",
      "default": false
    },
    "git_sync_remote": {
      "type": "string",
      "title": "Git Sync Remote",
      "description": "Git remote name for sync pulls",
      "required": false,
      "default": "origin"
    },
    "git_sync_branch": {
      "type": "string",
      "title": "Git Sync Branch",
      "description": "Branch to pull during sync",
      "required": false,
      "default": "main"
    },
    "git_sync_interval": {
      "type": "number",
      "title": "Git Sync Interval (seconds)",
      "description": "How often to pull from remote (in seconds)",
      "required": false,
      "default": 60
    },
    "git_sync_recursive": {
      "type": "boolean",
      "title": "Recursive Submodules",
      "description": "Include --recurse-submodules when pulling",
      "default": false
    },
    "git_sync_token": {
      "type": "string",
      "title": "Git Sync Token",
      "description": "GitHub PAT for authenticated git pulls. Falls back to Git Clone Token if not set.",
      "required": false,
      "default": ""
    },
    "git_author": {
      "type": "string",
      "title": "Git Author",
      "description": "Default author for git commits (format: 'Name <email>')",
      "required": false,
      "default": "stash-mcp <stash@local>"
    },
    "search_enabled": {
      "type": "boolean",
      "title": "Enable Semantic Search",
      "description": "Enable vector-based semantic search across content",
      "default": false
    },
    "embedding_model": {
      "type": "string",
      "title": "Embedding Model",
      "description": "Pydantic AI embedder model (e.g. sentence-transformers:all-MiniLM-L6-v2, openai:text-embedding-3-small)",
      "required": false,
      "default": "sentence-transformers:all-MiniLM-L6-v2"
    },
    "search_index_dir": {
      "type": "directory",
      "title": "Search Index Directory",
      "description": "Directory to store the vector search index",
      "required": false,
      "default": "${HOME}/.stash-index"
    },
    "search_chunk_size": {
      "type": "number",
      "title": "Search Chunk Size",
      "description": "Character count per text chunk for indexing",
      "required": false,
      "default": 1000
    },
    "search_chunk_overlap": {
      "type": "number",
      "title": "Search Chunk Overlap",
      "description": "Character overlap between adjacent chunks",
      "required": false,
      "default": 100
    },
    "model_cache_dir": {
      "type": "directory",
      "title": "Model Cache Directory",
      "description": "Directory for caching embedding model weights",
      "required": false,
      "default": "${HOME}/.stash-models"
    },
    "contextual_retrieval": {
      "type": "boolean",
      "title": "Contextual Retrieval",
      "description": "Enrich chunks with contextual summaries during indexing (requires Anthropic API key)",
      "default": false
    },
    "contextual_model": {
      "type": "string",
      "title": "Contextual Model",
      "description": "Anthropic model for contextual retrieval enrichment",
      "required": false,
      "default": "claude-haiku-4-5-20251001"
    },
    "anthropic_api_key": {
      "type": "string",
      "title": "Anthropic API Key",
      "description": "Required for contextual retrieval feature",
      "required": false,
      "default": ""
    },
    "openai_api_key": {
      "type": "string",
      "title": "OpenAI API Key",
      "description": "Required when using OpenAI embedding models",
      "required": false,
      "default": ""
    },
    "transaction_timeout": {
      "type": "number",
      "title": "Transaction Timeout (seconds)",
      "description": "Maximum duration for a write transaction before auto-abort",
      "required": false,
      "default": 300
    },
    "transaction_lock_wait": {
      "type": "number",
      "title": "Transaction Lock Wait (seconds)",
      "description": "How long to wait for a transaction lock before failing",
      "required": false,
      "default": 120
    }
  },
  "tools": [
    { "name": "read_content", "description": "Read file content with SHA-256 hash" },
    { "name": "read_content_batch", "description": "Read multiple files with SHA-256 hashes (max 10)" },
    { "name": "list_content", "description": "List files and directories in the content store" },
    { "name": "inspect_content_structure", "description": "Parse markdown heading hierarchy for a file" },
    { "name": "inspect_content_structure_batch", "description": "Parse markdown heading hierarchy for multiple files (max 10)" },
    { "name": "create_content", "description": "Create a new file" },
    { "name": "overwrite_content", "description": "Replace the full content of an existing file" },
    { "name": "edit_content", "description": "Apply targeted string-replacement edits to a file" },
    { "name": "edit_content_batch", "description": "Atomically apply edits to multiple files" },
    { "name": "delete_content", "description": "Delete a content file" },
    { "name": "move_content", "description": "Move or rename a file" },
    { "name": "move_content_directory", "description": "Move or rename an entire directory tree" },
    { "name": "move_content_batch", "description": "Move or rename multiple files in a single operation (max 10)" },
    { "name": "search_content", "description": "Semantic similarity search across content" },
    { "name": "log_content", "description": "View git commit history for a file" },
    { "name": "diff_content", "description": "Show what changed in a file since a given git ref" },
    { "name": "blame_content", "description": "View line-level authorship and timestamps" },
    { "name": "start_content_transaction", "description": "Begin a write transaction" },
    { "name": "commit_content_transaction", "description": "Commit all changes in the active transaction" },
    { "name": "abort_content_transaction", "description": "Abort the active transaction and discard changes" },
    { "name": "list_content_transactions", "description": "List active content transactions and their status" }
  ],
  "tools_generated": true,
  "keywords": ["documentation", "knowledge-base", "semantic-search", "content-management", "git"],
  "compatibility": {
    "platforms": ["darwin", "win32", "linux"],
    "runtimes": {
      "python": ">=3.12"
    }
  }
}
