services:
  stash-mcp:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        SEARCH_EXTRA: search-openai
    container_name: stash-mcp
    ports:
      - "8000:8000"
    volumes:
      - ./content:/data/content
      - ./stash-index:/data/stash-index
    environment:
      - STASH_CONTENT_ROOT=/data/content
      - STASH_HOST=0.0.0.0
      - STASH_PORT=8000
      - STASH_SEARCH_ENABLED=true
      - STASH_SEARCH_INDEX_DIR=/data/stash-index
      - STASH_SEARCH_EMBEDDER_MODEL=openai:text-embedding-3-large
      - OPENAI_API_KEY=${OPENAI_API_KEY}
    restart: unless-stopped
